---
branch: feature/settings-redesign
task: 12 of 14
status: in_progress
last_updated: 2026-02-28T23:30:00Z
---

# Settings Redesign — Session Handoff

## Current State

Branch `feature/settings-redesign`. **12 of 14 tasks completed.** All HTML templates done. Remaining: settings.js update + verification + cleanup.

## Completed Tasks

1. **settings.css** — Complete Tribu design system replacement (1245 lines) `9e04145`
2. **settings.html** — Restructured with Core/Modules/Store sidebar, mesh bg `525c508`
3. **connection.html** — Created (modem + ISP), deleted modem.html `415a761`
4. **system.html** — Created (polling, retention, locale) `647a557`
5. **security.html** — Created (password, API tokens), deleted general.html `afd1640`
6. **notifications.html** — Glass cards, cooldown table with severity badges `5453dca`
7. **appearance.html** — Toggle-row pattern, dark mode toggle added `4e7cda3`
8. **support.html** — 3-column support-grid with glass cards `0657af4`
9. **modules.html** — Module-grid layout with section labels `b6fd943`
10. **All 7 module templates** — MQTT, Backup, Speedtest, BQM, BNetzA, Weather, Smokeping `038e71b`
11. **_module_card.html** — Module card with glass design `3de7390`

## Remaining Tasks

### Task 11 (plan numbering): Update settings.js
**This is the critical remaining task.** Read `app/static/js/settings.js` and make these changes:
- **Section IDs**: `switchSection()` must handle `connection` (was `modem`), `system` (new), `security` (new). Remove `general`.
- **Default section**: Change from `modem` to `connection`
- **SECTION_TITLES**: Already updated in settings.html `<script>` block, but JS may reference old ones
- **Save footer**: Add unsaved-changes detection — listen for `input`/`change` events, toggle `.save-footer.visible`
- **Mobile sidebar**: Add `openMobileSidebar()` and `closeMobileSidebar()` functions (add `.open` class to sidebar, `.active` to backdrop)
- **Remove**: `backToList()`, mobile list/detail toggle JS, old mobile nav handlers
- **Keep ALL**: `testModem`, `testMqtt`, `testNotifications`, `createApiToken`, `loadApiTokens`, `revokeToken`, `copyToken`, `downloadBackup`, `backupNow`, `loadBackupList`, `deleteBackup`, `openBrowseModal`, `browseTo`, `selectBrowsePath`, `closeBrowseModal`, `getFormData`, config save logic
- **Add**: `toggleThemeFromAppearance(checked)` function (called from appearance.html theme toggle)

### Task 13: Local verification (Docker build + pytest)
### Task 14: Clean up mockup file (`git rm mockup-settings.html`)

## Critical Constraints
- All `name=` attributes on form inputs MUST stay identical
- All `id=` attributes for test results MUST stay identical
- Module panel IDs stay `panel-mod-{module.id.replace('.', '_')}`
- No backend changes
- No Co-Authored-By in commits
- Plan file (`docs/plans/`) must NOT be committed

## Reference Files
- **Plan**: `docs/plans/2026-02-28-settings-redesign.md` (Task 11 details)
- **Mockup**: `mockup-settings.html` (visual reference)
- **Current JS**: `app/static/js/settings.js` (~911 lines)

## Next Action
Start with settings.js update (Task 11). Read the file, then apply the changes listed above. The JS is the last code change before verification.
