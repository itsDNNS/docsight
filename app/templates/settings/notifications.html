<!-- ═══ Panel: Notifications ═══ -->
<div class="settings-panel" id="panel-notifications">
    <!-- Webhook Config Card -->
    <div class="settings-card glass">
        <div class="card-header">
            <div class="card-title-group">
                <div class="card-icon purple">
                    <i data-lucide="bell"></i>
                </div>
                <div>
                    <div class="card-title">Notifications</div>
                    <div class="card-subtitle">Webhook notifications (ntfy, Discord, Gotify, custom)</div>
                </div>
            </div>
        </div>
        <div class="form-grid cols-2">
            <div class="form-field" style="grid-column: 1 / -1">
                <label class="form-label" for="notify_webhook_url">Webhook URL</label>
                <input class="form-input" type="url" id="notify_webhook_url" name="notify_webhook_url" value="{{ config.notify_webhook_url }}" placeholder="https://ntfy.sh/docsight">
                <span class="form-hint">HTTP POST endpoint (ntfy, Discord, Gotify, custom)</span>
            </div>
            <div class="form-field" style="grid-column: 1 / -1">
                <label class="form-label" for="notify_webhook_token">Webhook Token</label>
                <input class="form-input" type="password" id="notify_webhook_token" name="notify_webhook_token" value="" placeholder="{% if config.notify_webhook_token %}{{ t.saved_ph|default('Saved') }}{% endif %}">
                <span class="form-hint">Optional Bearer token for authentication</span>
            </div>
            <div class="form-field">
                <label class="form-label" for="notify_min_severity">Min. Severity</label>
                <select class="form-input form-select" id="notify_min_severity" name="notify_min_severity">
                    <option value="info" {% if config.notify_min_severity == 'info' %}selected{% endif %}>Info</option>
                    <option value="warning" {% if config.notify_min_severity == 'warning' or not config.notify_min_severity %}selected{% endif %}>Warning</option>
                    <option value="critical" {% if config.notify_min_severity == 'critical' %}selected{% endif %}>Critical</option>
                </select>
                <span class="form-hint">Only send events at or above this severity</span>
            </div>
            <div class="form-field">
                <label class="form-label" for="notify_cooldown">Default Cooldown (s)</label>
                <input class="form-input" type="number" id="notify_cooldown" name="notify_cooldown" value="{{ config.notify_cooldown or 3600 }}" min="0" step="1">
                <span class="form-hint">Min. seconds between same event type (0 = never send)</span>
            </div>
        </div>
    </div>

    <!-- Per-Event Cooldowns Card -->
    <div class="settings-card glass">
        <div class="card-header">
            <div class="card-title-group">
                <div class="card-icon amber">
                    <i data-lucide="timer"></i>
                </div>
                <div>
                    <div class="card-title">Per-Event Cooldowns</div>
                    <div class="card-subtitle">Disable events or set individual cooldown timers</div>
                </div>
            </div>
        </div>
        <table class="cooldown-table">
            <thead>
                <tr>
                    <th>Active</th>
                    <th>Event</th>
                    <th>Severity</th>
                    <th>Cooldown (s)</th>
                </tr>
            </thead>
            <tbody>
                <tr class="notify-event-row" data-event="health_change">
                    <td><label class="toggle"><input type="checkbox" class="notify-toggle" data-event="health_change" checked><span class="toggle-slider"></span></label></td>
                    <td><span class="event-name">Health Change</span></td>
                    <td><span class="badge badge-danger">critical</span></td>
                    <td><input type="number" class="form-input cooldown-input notify-cooldown-input" data-event="health_change" min="1" step="1" placeholder="default"></td>
                </tr>
                <tr class="notify-event-row" data-event="power_change">
                    <td><label class="toggle"><input type="checkbox" class="notify-toggle" data-event="power_change" checked><span class="toggle-slider"></span></label></td>
                    <td><span class="event-name">Power Change</span></td>
                    <td><span class="badge badge-warning">warning</span></td>
                    <td><input type="number" class="form-input cooldown-input notify-cooldown-input" data-event="power_change" min="1" step="1" placeholder="default"></td>
                </tr>
                <tr class="notify-event-row" data-event="snr_change">
                    <td><label class="toggle"><input type="checkbox" class="notify-toggle" data-event="snr_change" checked><span class="toggle-slider"></span></label></td>
                    <td><span class="event-name">SNR Change</span></td>
                    <td><span class="badge badge-warning">warning</span></td>
                    <td><input type="number" class="form-input cooldown-input notify-cooldown-input" data-event="snr_change" min="1" step="1" placeholder="default"></td>
                </tr>
                <tr class="notify-event-row" data-event="channel_change">
                    <td><label class="toggle"><input type="checkbox" class="notify-toggle" data-event="channel_change" checked><span class="toggle-slider"></span></label></td>
                    <td><span class="event-name">Channel Change</span></td>
                    <td><span class="badge badge-muted">info</span></td>
                    <td><input type="number" class="form-input cooldown-input notify-cooldown-input" data-event="channel_change" min="1" step="1" placeholder="default"></td>
                </tr>
                <tr class="notify-event-row" data-event="modulation_change">
                    <td><label class="toggle"><input type="checkbox" class="notify-toggle" data-event="modulation_change" checked><span class="toggle-slider"></span></label></td>
                    <td><span class="event-name">Modulation Change</span></td>
                    <td><span class="badge badge-muted">info</span></td>
                    <td><input type="number" class="form-input cooldown-input notify-cooldown-input" data-event="modulation_change" min="1" step="1" placeholder="default"></td>
                </tr>
                <tr class="notify-event-row" data-event="error_spike">
                    <td><label class="toggle"><input type="checkbox" class="notify-toggle" data-event="error_spike" checked><span class="toggle-slider"></span></label></td>
                    <td><span class="event-name">Error Spike</span></td>
                    <td><span class="badge badge-danger">critical</span></td>
                    <td><input type="number" class="form-input cooldown-input notify-cooldown-input" data-event="error_spike" min="1" step="1" placeholder="default"></td>
                </tr>
                <tr class="notify-event-row" data-event="monitoring_started">
                    <td><label class="toggle"><input type="checkbox" class="notify-toggle" data-event="monitoring_started" checked><span class="toggle-slider"></span></label></td>
                    <td><span class="event-name">Monitoring Started</span></td>
                    <td><span class="badge badge-success">success</span></td>
                    <td><input type="number" class="form-input cooldown-input notify-cooldown-input" data-event="monitoring_started" min="1" step="1" placeholder="default"></td>
                </tr>
            </tbody>
        </table>
        <span class="form-hint" style="display:block;margin-top:var(--space-md);">Disabled events will never be sent. Cooldown empty = use default.</span>
    </div>

    <!-- Test Card -->
    <div class="settings-card glass">
        <div class="card-header">
            <div class="card-title-group">
                <div class="card-icon green">
                    <i data-lucide="send"></i>
                </div>
                <div>
                    <div class="card-title">Test Notification</div>
                    <div class="card-subtitle">Send a test event to verify your webhook configuration</div>
                </div>
            </div>
        </div>
        <button type="button" class="btn btn-ghost" onclick="testNotifications()">
            <i data-lucide="send" style="width:16px;height:16px;"></i>
            Send Test
        </button>
        <div class="test-result" id="notify-test"></div>
    </div>
</div>
